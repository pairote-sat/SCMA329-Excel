[["index.html", "SCMA329 Practical Mathematical Financial Modeling Section 1 Dates and date functions 1.1 Inconsistent date entries 1.2 Date serial number 1.3 Date functions", " SCMA329 Practical Mathematical Financial Modeling Pairote Satiracoo 2021-08-27 Section 1 Dates and date functions Dates and date functions will be discussed in this section. Depending on the system setting, the dates used in this section corresponds to the U.S. setting, i.e. month/day/year. Thus, 7/1/2017 corresponds to 1 July 2017. The following date formats are recognized by Excel: 7/1/2017, 7/1/17 7-1-2017, 7-1-17, 7-1/2017, 7-1/17, July 1, 2017 1-Jul-2017 if the date input is without the year, then it is the date on the current year, i.e. 7-1, 7/1, July 1, Jul 1, corresponds to 1 July 2018. 1.1 Inconsistent date entries Example 1.1 Example 1. What will be the output when we enter dates by using the following two digits for the years: 7/1/01 7/1/60 Excel interprets two digit years between 00 and 29 as 21st century dates, and two digit years between 30 and 99 as 20th century dates. 1.2 Date serial number Excel stores dates as sequential serial numbers so that they can be used in calculations. For example, 1 January 1900 is serial number 1, 1 January 2018 is serial number 43101 because it is 43101 days after 1 January 1900. 1.3 Date functions The list of date functions can be seen by choosing Formulas \\(\\rightarrow\\) Function Library \\(\\rightarrow\\) Function Library \\(\\rightarrow\\) Date &amp; Time. Function Description DATE Returns the serial number of a particular date DATEVALUE Converts a date in the form of text to a serial number DAY Converts a serial number to a day of the month DAYS Returns the number of days between two dates WEEKDAY Converts a serial number to a day of the week NETWORKDAYS Returns the difference between two dates, excluding weekend days (Saturdays and Sundays) WORKDAY Returns a number that represents a date that is the indicated number of working days before or after a date (the starting date) EDATE Returns the serial number that represents the date that is the indicated number of months before or after a specified date EOMONTH Returns the serial number for the last day of the month that is the indicated number of months before or after a specified date YEARFRAC Returns a decimal value that represents fractional years between two dates For a complete list, see the date and time functions available online. More detailed examples are also given in the Excel lab. "],["working-with-texts.html", "Section 2 Working with Texts 2.1 Text functions 2.2 Character codes 2.3 Determining whether two string are identical 2.4 Joining two or more cells", " Section 2 Working with Texts In this section, we will see how Excel handles text strings, and how we use text functions to modify and manipulate text strings. First, we give a note regarding texts in Excel. A single cell can hold up to 32,000 characters. In case you need to display a lot of text in a worksheet, then use a text box (Choose Insert \\(\\Rightarrow\\) Text \\(\\Rightarrow\\) Text Box). It will be easier to edit texts in the text box than in cells. Sometimes, when you download numerical data from the internet or database, the imported values are treated as text, i.e. when you do a calculation with such data, you will get a #VALUE error. When a number is not treated as a number, there will be an error indicator. By clinking to expand a list of options, you can then convert it to the number. Another issue that you may encounter is about currency that uses different characters to separate thousands or decimals. https://en.wikipedia.org/wiki/Decimal_separator 2.1 Text functions The following Excel functions can be used to modify text strings in the format you need. Alternatively, one may extract data by using the Convert Text To Columns Wizard (choose Data \\(\\Rightarrow\\) Text To Columns). RIGHT(text,[n]) returns the last \\(n\\) characters in a text string. LEFT(text, [n]) returns the first \\(n\\) characters in a text string. MID(text, start_num, num_chars) returns num_char characters from a text string, starting at start_num. TRIM(text) removes all spaces from text except for single spaces between words. Use TRIM when text strings have irregular spacing. LEN(text) returns the number of characters in a text string. FIND(find_text, within_text, [start_num]) return the location at or after character start_num of the first character of find_text in within_text. SEARCH(find_text, within_text, [start_num]) has the same syntax as FIND, but it is not case sensitive. SUBSTITUTE(text, old_text, new_text, [instance_num]) is used to replace new_text for old_text in a text string. Here Instance_num is optional. It specifies which occurrence of old_text you want to replace with new_text. If you specify instance_num, only that instance of old_text is replaced. Otherwise, every occurrence of old_text in text is changed to new_text. 2.2 Character codes Excel uses the standard ASCII character set. Therefore, each character has its own code. For example, to get the code number of “A”, simply type =CODE(“A”), which returns the code number 65. The CHAR function reverses the role of CODE function, i.e. =CHAR(65), which returns the letter A. The input for the CHAR function should be a value between 1 and 255. For the complete list of ASCII codes, please visit https://theasciicode.com.ar Example 2.1 Example 1. Create an Excel file to list all the first 255 ASCII codes. It is a good idea to compare the outputs with those from the website above. 2.3 Determining whether two string are identical In order to determine whether strings in cell A1 and A2 have the same contents, we use = A1 = A2, which returns either TRUE or FALSE. Note that the comparison is not case-sensitive. Alternative, the function that provides an exact, case-sensitive comparison is EXACT function. 2.4 Joining two or more cells To join two or more cells, Excel uses an ampersand &amp;. For example if the string “the effective interest rate per annum” is in A1 and the value of 5% (formatted value) is in B1. Then use the formula = A1 &amp; ” is ” &amp; B1, which returns the effective interest rate per annum is 0.05. A better solution is to use the TEXT function to format the value as text as follows. = A1 &amp; ” is ” &amp; TEXT(B1,” 0.00%“) , which returns the effective interest rate per annum is 0.05. Use Home Format Format cells to obtain the list of various text formats. For example, if A1 contains the principle of $10,000, then = “The principle is” &amp; TEXT(A1, ” $#,##0”), which returns The principle is $10,000. The following table gives examples that are format with TEXT function. =TEXT(1234.567,&quot;$#,##0.00&quot;) Currency with a thousands separator and 2 decimals, like $1,234.57. Note that Excel rounds the value to 2 decimal places. =TEXT(TODAY(),&quot;MM/DD/YY&quot;) Today&#39;s date in MM/DD/YY format, like 03/14/12 =TEXT(TODAY(),&quot;DDDD&quot;) Today&#39;s day of the week, like Monday =TEXT(NOW(),&quot;H:MM AM/PM&quot;) Current time, like 1:29 PM =TEXT(0.285,&quot;0.0%&quot;) Percentage, like 28.5% =TEXT(4.34 ,&quot;# ?/?&quot;) Fraction, like 4 1/3 =TRIM(TEXT(0.34,&quot;# ?/?&quot;)) Fraction, like 1/3. Note this uses the TRIM function to remove the leading space with a decimal value. =TEXT(12200000,&quot;0.00E+00&quot;) Scientific notation, like 1.22E+07 =TEXT(1234567898,&quot;[&lt;=9999999]###-####;(###) ###-####&quot;) Special (Phone number), like (123) 456-7898 =TEXT(1234,&quot;0000000&quot;) Add leading zeros (0), like 0001234 The TEXT function will convert numbers to text. It is best practice to keep your original values in one cell, and formatted number in another cell. When you do calculation, you should refer to the cells containing original values. "],["interest-rate-present-values-and-cashflows.html", "Section 3 Interest Rate, Present Values and Cashflows 3.1 Working with a single cashflow in Excel 3.2 Present values of a series of cashflows", " Section 3 Interest Rate, Present Values and Cashflows 3.1 Working with a single cashflow in Excel 3.1.1 How to calculate the future value of a single cashflow Suppose an amount \\(C\\) is deposited in an account that pays a fixed interest at the rate of \\(i\\)% per time units. Then after \\(t\\) time units, the deposit will have accumulated to \\[C (1+i)^t.\\] In Excel, the function FV calculates the future value of a single investment (and also periodic constant payments) and a constant interest rate. The syntax of the function is: \\[\\text{FV(rate, nper, pmt, [pv], [type])},\\] where rate is the interest rate per period nper is the number of periods over which the investment is made. pmt (used for an annuity type) is the payment made each period and cannot change over the life of the annuity. pv (optional) is an additional cash flow now (time 0) fv is an additional cash flow nper periods from now. type (optional) is an optional argument that defines whether the payment is made at the start or the end of the period: 0 - the payment is made at the end of the period; 1 - the payment is made at the start of the period. If the [type] argument is omitted, it takes on the default value of 0. The following timeline illustrates the cashflows used for the FV function (assuming that the payments (pmt) are made in arrears). Figure 3.1: Timeline of cashflows for FV function Note For a single cash flow, we set pmt argument to be 0, as there are no ongoing payments after the initial investment. Example 3.1 Example 1. You plan to invest today with an interest rate of 3% per year effective. How much money will you accumulate at the end of 2 years? Solution: The accumulation of today in 2 years can be calculated by Excel as \\[\\text{FV}(3\\%, 2, 0, -100).\\] 3.1.2 How to calculate the present value of a single cashflow Similarly, the present value of a future cashflow \\(C\\) required at time \\(t\\) time units at a fixed interest of \\(i\\)% per time units can be calculated as \\[\\frac{C}{(1+i)^t}.\\] In Excel, the function PV calculates the present value of a single investment (and also periodic constant payments) and a constant interest rate. The syntax of the function is: \\[\\text{PV(rate, nper, pmt, [fv], [type])}\\] where fv is an additional cash flow nper periods from now. Example 3.2 Example 2. How much should you deposit into the account with an interest of 8% so that 10 years from now its value would be ? Solution: The present value of today in 10 years can be calculated by Excel as \\[\\text{PV}(8\\%, 10, 0, -1000).\\] 3.2 Present values of a series of cashflows Consider a series of cashflows defined by the times of payments (cashflows), denoted by \\(t_1, t_2, \\ldots,\\) and the amount of payments, denoted by \\(C_{r}\\) (in short for \\(C_{t_r}\\)), which will be paid at time \\(t_r\\), for \\(r = 1,2, \\ldots\\). The amounts can be positive or negative The present value at any time \\(t\\) of this series of cashflow is \\[PV(t) = \\sum_{r=1}^\\infty C_r (1 + i)^{t - t_r} = \\sum_{r=1}^\\infty C_r v^{t _r - t}\\] where \\(i\\) is the effective rate of interest and \\(v = 1/(1+i)\\). Figure 3.2: Timeline of a series of cashflows Notes 1. At a fixed effective rate of interest, the original series of cashflows is equivalent to a single payment of amount \\(PV(t)\\) at time \\(t\\). If two different series of cashflows have the same \\(PV\\) at one time at a given effective rate of interest, then they have the same \\(PV\\) at any time at that effective rate of interest. 3.2.1 Level Annuities certain An annuity is a regular series of payments (cashflows). When the payments are certain which are payable for a definite period of time, we call it an annuity certain. If the payments are made at the end of each time period, they are paid in arrear. Otherwise, payments are made at the beginning of each time period, they are pain in advance. An annuity paid in advance is also known as an annuity due If each payment is for the same amount, this is a level annuity. Example 3.3 Example 3. Let \\(i\\) be the constant effective rate of interest per time unit. In Excel, one can calculate the accumulated value of a level annuity certain having cashflow of pmt unit at the end of each of the next \\(n\\) time units by \\[\\text{FV}(i\\%, n, pmt, 0).\\] The cashflows of this annuity is shown in the timeline below. Figure 3.3: Level Annuity Certain Note The last argument of the above syntax, [pv] (optional) which is an additional cash flow now (at time 0), has been set to 0. Example 3.4 Example 4. Let \\(i\\) be the constant effective rate of interest per time unit. In Excel, one can calculate the present value at time 0 of a level annuity certain having cashflow of pmt unit at the end of each of the next \\(n\\) time units by \\[\\text{PV}(i\\%, n, pmt, 0).\\] The timeline of these cashflows is shown in the figure below: Figure 3.4: Level Annuity Certain Note The last argument of the above syntax, [fv] (optional) which is an additional cash flow at time \\(n\\), has been set to 0. Example 3.5 Example 5. Given the effective rate of interest of \\(8\\%\\) p.a., use Excel to calculate the accumulation at 12 years of payable yearly in arrear for the next 12 years. the present value now of ,000 payable yearly in arrear for the next 6 years. the present value now of ,000 payable half-yearly in arrear for the next 12.5 years. Example 3.6 Example 6. Let \\(i = 4\\%\\) effective per time unit. Cashflows are given as follows: \\(C_1 = 200\\) at time \\(t_1 = 1\\). \\(C_2 = 300\\) at time \\(t_2 = 3\\). \\(C_3 = -100\\) at time \\(t_3 = 5\\). \\(C_4 = -50\\) at time \\(t_4 = 6\\). Develop the model using Excel to calculate the accumulation at time \\(t = 7\\). the present value at time \\(t = 0\\). the present value at time \\(t = 4\\). "]]
